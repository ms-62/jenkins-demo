pipeline {
    // GitHub Actionsì˜ `runs-on: ubuntu-latest / windows-latest` ì™€ ìœ ì‚¬
    // â†’ ì´ íŒŒì´í”„ë¼ì¸ì„ ì‹¤í–‰í•  Jenkins ì‹¤í–‰ ë…¸ë“œ(ì—ì´ì „íŠ¸)ë¥¼ ì§€ì •
    // `any` = Jenkinsê°€ ì‚¬ìš© ê°€ëŠ¥í•œ ì•„ë¬´ ë…¸ë“œì—ì„œë‚˜ ì‹¤í–‰
    agent any

    environment {
        DISCORD_WEBHOOK = "https://discord.com/api/webhooks/12345/abcde"
    }

    // GitHub Actionsì˜ `on: push:` ì™€ ê°™ì€ ì—­í• 
    // â†’ GitHubì— push ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ë©´ ì´ íŒŒì´í”„ë¼ì¸ì„ ìë™ ì‹¤í–‰
    triggers {
        githubPush()
    }

    stages {
        // GitHub Actionsì˜ `jobs:` ë˜ëŠ” `steps:` ì¤‘
        // "ì˜ë¯¸ ìˆëŠ” ì‘ì—… ë‹¨ìœ„"ì— í•´ë‹¹.
        // CI ê³¼ì •ì˜ í° ë‹¨ê³„ë¼ê³  ë³´ë©´ ë¨
        stage('Run CI Script') {

            steps {
                // GitHub Actionsì˜ `run:` ê³¼ ë™ì¼í•œ ê°œë…
                // â†’ ì‹¤ì œë¡œ ì‹¤í–‰ë  ì»¤ë§¨ë“œ
                sh './main.sh'

                // ë§Œì•½ GitHub Actionsì˜€ë‹¤ë©´ ì•„ë˜ì™€ ë¹„ìŠ·í•¨
                // run: main.sh
            }
        }
    }
    post {
            success {
            discordSend(
                webhookURL: "${env.DISCORD_WEBHOOK}",
                title: "âœ… ë¹Œë“œ ì„±ê³µ: ${env.JOB_NAME} #${env.BUILD_NUMBER}",
                result: "SUCCESS",
                description: "ì‘ì—…ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."
            )
        }
        failure {
            discordSend(
                webhookURL: "${env.DISCORD_WEBHOOK}",
                title: "ğŸš¨ ë¹Œë“œ ì‹¤íŒ¨: ${env.JOB_NAME} #${env.BUILD_NUMBER}",
                result: "FAILURE",
                description: "ì—ëŸ¬ ë¡œê·¸ë¥¼ í™•ì¸í•´ ì£¼ì„¸ìš”!"
            )
        }
    }
}
